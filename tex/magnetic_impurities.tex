\section[Magnetic impurities]{\texorpdfstring{Magnetic impurities in metals - \\ \null\hfill The Anderson and Kondo models}}
(page 183-> in pdf, 139-> in notes)

Imagine that we have a system defined by free, itinerant electrons, described by a conduction band with dispersion relation $\varepsilon_k$ and, for the sake of simplicity, assume that the one-particle density of state has a simple form as shown in Figure \ref{fig:dos}. The bandwidth of this system is $2D$, and the system has a Hamiltonian
\begin{equation}
	\label{eq:hamiltonian_free}
	\Ha_c = \sum_{k, \sigma}\varepsilon_k c_{k\sigma}^\dagger c_{k\sigma}.
\end{equation}

\begin{figure}[h]
	\centering
	\input{tex/img/DOS}
	\caption{Density of states}
	\label{fig:dos}
\end{figure}

We will study the effect of including a magnetic impurity in the problem, where the magnetic impurity couples to the charged electrons, but is localized in space. First we consider the system with exactly one impurity. The Hamiltonian for this impurity is given by

\begin{equation}
\label{eq:hf}
	\Ha_f = E_0\sum_m f_m^\dagger f_m + U f_{\frac{1}{2}}^\dagger f_{-\frac{1}{2}}^\dagger f_{-\frac{1}{2}}f_{\frac{1}{2}},
\end{equation}

where $m$ are quantum numbers determining the z-component of the spin of the impurity. $(f_m, f_m^\dagger)$ are annihilation and creation operators for the impurity, in state $m$. $s = \frac{1}{2}: m = \pm 1$. $U$ is the Coulomb energy associated with double occupancy of the magnetic impurity. We will later assume that this is the largest energy in the system. The coupling between the charges and the localized impurity is given by
\begin{equation}
	\label{eq:interaction_term}
	\Ha_{cf}= \sum_{\vb k,\sigma,m}\left(V_{m\sigma}(\vb{k}) f_m^\dagger c_{\vb k\sigma}  + \text{h.c.}\right).
\end{equation}

In \eqref{eq:interaction_term}, $V_{m\sigma}(\vb k) $ is the matrix element transfering an electron from the impurity to the conduction band, or opposite. 
The total Hamiltonian is
\begin{equation}
	\Ha = \Ha_c + \Ha_f + \Ha_{cf}.
\end{equation}
$\Ha$ is often called the Anderson model. This model is the fundament for our understanding of heavy fermion systems. We will now use the techniques to study the effects of including a magnetic impurity in the conduction band. 
One important effect of magnetic impurities is that a metal will exhibit a minima in resistivity (see Figure \ref{fig:resistivity}).
\begin{figure}
	\centering
	\input{tex/img/resistivity}
	\caption{Resistivity}
	\label{fig:resistivity}
\end{figure}
$T_K$ is only a couple of Kelvin, but the Fermi-energy is of order $10^4\mathrm{K}$. How can an energy scale this small arise when the basis is that the relevant energy scale is $\varepsilon_F \sim 10^4\mathrm{K}$? If magnetic impurities are excluded, the resistivity is uniformly decreasing. Jun Kondo found that $\rho(T) \sim -\ln T$ diverges in perturbation theory at low temperatures\footnote{Progress of Theoretical Physics, Vol. 32, No. 1, pp. 37-49}. A new problem then arises; how can we give a consistent description of low temperaturre physics, $T<<T_K$, in systems with a minima in resistivity? This problem is often referred to as the ``Kondo problem''. 

What we will do, is to see how the energy scale $T_K$, The Kondo temperature, arises, as well as to give a consistent description of the lowÃ¦-temperature physics in metals doped with magnetic impurities, in a saddle point approxiimation.
Typical materials described by these theories are metals like aluminium and gold, doped with other rare materials. These materials are then the magnetic impurities in the problem. Rare materials: Lanthanides and actinides. Most studied: Cerium (Lanthanide) and Uranium (actinide). In the lanthanides the valence electrons are in the 4f-shell, and in actinides they are in the 5f-shell (hence $f_m^\dagger, f_m)$). Regularly studied materials are $\mathrm{CeAl_2}$ (lanthanide) and $\mathrm{UPt_3}$ (Actinide). $\mathrm{UPt_3}$ is a very odd superconductor with $T_C \sim 1\mathrm{mK}$ and a very complicated order parameter.  

Let us simplify the Anderson model;

\textbf{i)}: $U = \infty$.

Doubly occupancy of the magnetic impurities are not allowed. If there already exist a spin on the lattice site of the impurity, a conducting electron can not enter this localized orbital.

\textbf{ii)}: We assume that the coupling between $f$- and $c$-electrons are such that $m = \sigma$,  i.e. 
\begin{equation}
	V_{m\sigma}(k) =\delta_{m\sigma}V(k), 
\end{equation}
and that $V(k)$ is $k$-independent (completely localized coupling)
\begin{equation}
	V_{m\sigma}(k) = V\delta_{m\sigma}
\end{equation}
which implies
\begin{equation}
	\Ha_{cf} = V\sum_{\sigma k}\left(f_\sigma^\dagger c_{k\sigma} + h.c.\right).
\end{equation}

Thus, we have the model 
\begin{align}
	\begin{split}
	\Ha &= E_0\sum_{\sigma}f_\sigma^\dagger f_\sigma + \sum_{k,\sigma}\varepsilon_k c_{k\sigma}^\dagger c_{ck}^\dagger \\
	&= V\sum_{k,\sigma}\left[f_{\sigma}^\dagger c_{k\sigma} + h.c. \right],
	\end{split}
\end{align}

with \(\sum_mf_m^\dagger f_m \leq 1 \). It is the restiriction on the occupation number on the impurities that makes this a hard problem.

For later reference, we first solve the problem with $U = 0$.
\subsection{$U = 0$}

\begin{equation}
\Z = \int \D c^\dagger \D c\D f^\dagger \D f\e^{\Sa}
\end{equation}
\begin{equation}
\Sa = -\int\left(\sum_{k,\sigma}c_{k\sigma}^\dagger\pdv{c_{k\sigma}}{\tau} + \sum_mf_m^\dagger \pdv{f_m}{\tau} + \Ha \right)\dd{\tau}
\end{equation}

\begin{align}
\begin{split}
\Sa = &- \int_0^\beta\sum_{k,\sigma}c_{k\sigma}^\dagger\left(\partial_\tau + \varepsilon_k\right)c_{k\sigma} \dd{\tau} \\
&-\int_0^\beta\sum_\sigma f_\sigma^\dagger\left(\partial_\tau + E_0\right)f_\sigma \dd{\tau}\\
&-\int_0^\beta V\sum_{k, \sigma}\left(f_\sigma^\dagger c_{k\sigma} + h.c.\right)\dd{\tau}
\end{split}
\end{align}
\(\Z\) can be computed exactly by a linear shift og the fermion operators \((c_{k\sigma}, c_{k\sigma}^\dagger)\). Introduce \(\Gre^{-1}= \partial_\tau + \varepsilon_k\). Consider now the quantity
\begin{align}
\label{eq:temp_derivation}
	&\sum_{k, \sigma}\left[c_{k\sigma}^\dagger \Gre^{-1}c_{k\sigma}+ Vf_{\sigma}^\dagger c_{k\sigma} + Vc_{k\sigma}^\dagger f_\sigma\right] \nonumber\\
	&= \sum_{k\sigma}\left(c_{k\sigma}^\dagger + Vf_\sigma^\dagger \Gre\right)\Gre^{-1}\left(c_{k\sigma} + V\Gre f_\sigma\right) -\sum_{k,\sigma}V^2f_\sigma^\dagger \Gre f_\sigma \nonumber\\
	&=\sum_{k\sigma}\tilde{c}_{k\sigma}^\dagger \Gre^{-1}\tilde{c}_{k\sigma} - \sum_\sigma f_\sigma^\dagger\left(\sum_k V^2\Gre\right)f_\sigma.
\end{align}
Inserting \eqref{eq:temp_derivation} into the action, we get
\begin{equation}
\label{eq:action_magnetic}
	S =-\sum_{k,\sigma}\tilde{c}_{k\sigma}^\dagger \Gre^{-1}\tilde{c}_{k\sigma}-\sum_\sigma f_\sigma^\dagger\left(\partial_\tau + E_0 - V^2\sum_k\frac{1}{\partial_\tau + \varepsilon_k}\right)f_\sigma.
\end{equation}
As we can see in \eqref{eq:action_magnetic}, the action is quadratic in the $c$- and $f$- sectors.

\begin{equation}
	\Z = \int\D\tilde{c}^\dagger\D\tilde{c}\D f^\dagger \D f\, \e^{\Sa}= \Z_c\cdot\Z_f,
\end{equation}
where 
\begin{align}
	\Z_c &= \e^{\Tr\ln \left(\Gre^{-1}\right)} & \Z_f&= \e^{\Tr\ln\left(\mathcal{G}_f^{-1}\right)}\\
	\label{eq:fermi_propagator}
	\Gre^{-1} &= \partial_\tau + \varepsilon_k &
	\mathcal{G}_f^{-1} &= \partial_\tau + E_0 -V^2\sum_k \frac{1}{\partial_\tau + \varepsilon_k}.
\end{align}

$\Z_c$ is the partition function for free electron gas, and $\Z_f$ is the partition function for the impurities, coupled to a free electron gas.

we have already considered
\begin{equation}
\label{eq:free_energy_non_interacting}
	\Tr\ln\Gre^{-1} = \sum_{k,\sigma}\ln\left(1 + \e^{-\beta\varepsilon_k}\right).
\end{equation}
\eqref{eq:free_energy_non_interacting} is the free energy for non-interacting electron gas, as we have seen earlier (see the derivation of \eqref{eq:partition_free_electron}).

\begin{equation}
\label{eq:trace_impurities}
	\Tr\ln\left(\mathcal{G}_f^{-1}\right) = \sum_\sigma\sum_{\omega_n}\ln\left(-i\omega_n + E_0 +V^2\sum_k \frac{1}{i\omega_n - \varepsilon_k}\right)
\end{equation}

Consider now the last $k$-summation in \eqref{eq:trace_impurities}.
\begin{align}
\label{eq:k_sum}
\begin{split}
	\sum_k\frac{1}{i\omega_n - \varepsilon_k} &= \frac{1}{2D}\int_{-D}^D\dd{\varepsilon}\frac{1}{i\omega_n - \varepsilon} \\
	&= \frac{1}{2D}\ln\left(\frac{D+i\omega_n}{-D + i\omega_n}\right)\\
	&=-\frac{1}{2D}\ln\left(\frac{\omega_n+iD}{\omega_n-iD}\right)
\end{split}
\end{align}
This is evaluated as
\begin{equation}
	\ln\left(\frac{z}{z^*}\right) = \ln\left(\frac{|z|e^{i\varphi}}{|z|\e^{-i\varphi}}\right) = 2i\varphi.
\end{equation}
Here, $\varphi = \tan[-1](\frac{D}{\omega_n}) \simeq \frac{\pi}{2}\mathrm{sgn}(\omega_n)$ as $T\rightarrow 0$.
This implies that we can write the $k$-sum in \eqref{eq:k_sum} as
\begin{align}
	\sum_k\frac{1}{i\omega_n - \varepsilon_k} &\simeq -i\frac{\pi\cdot 2}{2\cdot 2D}\mathrm{sgn}(\omega_n)\\
	&= -i\pi\rho_0\mathrm{sgn}(\omega_n)
\end{align}
where we introduced $\rho_0 = \flatfrac{1}{2D}$. Define $\Delta_0 \equiv \pi\rho_0 V^2$. Going back to \eqref{eq:trace_impurities}, we now have
\begin{equation}
	\sum_k\frac{1}{i\omega_n - \varepsilon_k} = \sum_\sigma\sum_{\omega_n}\ln\left(-i\omega + E_0 - i\Delta_0 \mathrm{sgn}(\omega_n)\right).
\end{equation}
Following the same methods as we have seen earlier, we have
\begin{align}
	\sum_{\omega_n}\dots &= \frac{-\beta}{2\pi i}\oint\dd{z}f(z)\ln(-z+E_0-i\Delta_0\mathrm{sgn}(\Im{z}))\nonumber\\
	&= -\frac{\beta}{2\pi i }\int_{-D}^{D}\dd{\varepsilon}f(\varepsilon)\left[\ln(-\varepsilon + E_0- i\Delta_0) - \ln(-\varepsilon + E_0 + i\Delta_0)\right] \nonumber\\
	\label{eq:action_derivation}
	&= \frac{\beta}{\pi}\int_{-D}^D\dd{\varepsilon}f(\varepsilon)\tan[-1](\frac{\Delta_0}{E_0 - \varepsilon}).
\end{align}
Thus, after the spin-summation, our total action is
\begin{equation}
\label{eq:action_impurities}
	\Sa = -2\sum_k\ln\left(1 + \e^{-\beta\varepsilon_k}\right) + \frac{2\beta}{\pi}\int_{-D}^D\dd{\varepsilon}f(\varepsilon)\tan[-1](\frac{\Delta_0}{E_0 - \varepsilon}).
\end{equation}
$\Sa$ describes a free electron gas, plus a scattering resonance at the energy $E_0$ caused by the coupling between  $f$- and $c$-electrons. Notice that if $|E_0| >> D$ ,the second term in \eqref{eq:action_impurities} can be neglected. The impurities are far from the conduction band, and does not matter. When $U = \infty$, this will drastically change this result, as we shall now see.

NB! The Green's functions:
\begin{align*}
	-\ev{ff^\dagger} &= -\left(\partial_\tau + E_0 - V^2 \sum_k\frac{1}{\partial_\tau + \varepsilon_k}\right)^{-1}\\
	&\rightarrow \left(i\omega_n-E_0 + V^2\sum_k \frac{1}{i\omega_n - \varepsilon_k}\right)^{-1} \\
	-\ev{\tilde{c}\tilde{c}^\dagger} &= -\frac{1}{\partial_\tau + \varepsilon_k} \\
	&\rightarrow \frac{1}{i\omega_n-\varepsilon_k},
\end{align*}
but the $\tilde{c}$-``electrons'' are \underline{not} physical electrons. We defined them as $\tilde{c} = c+V\Gre f_\sigma \Rightarrow c = \tilde{c} - V\Gre f_\sigma$.
Then, the conducting-electron-propagator is modified;
\begin{align*}
	-\ev{cc^\dagger} &= -\left[\ev{(\tilde{c}-V\Gre f_\sigma)(\tilde{c}^\dagger - V\Gre f_\sigma^\dagger)}\right]\\
	&= -\Gre + V\Gre\ev{\tilde{c}f^\dagger} + V\Gre\ev{f\tilde{c}^\dagger} - V^2\Gre\ev{ff^\dagger}\Gre
\end{align*}

The propagator for the conducting electrons is then
\begin{equation}
	\mathcal{G}(\partial_\tau, \varepsilon_k) = -\left[\Gre(\partial_\tau, \varepsilon_k) + V^2\Gre(\partial_\tau, \varepsilon_k)\mathcal{G}_f(\partial_\tau)\Gre(\partial_\tau, \varepsilon_k)\right]
\end{equation}
\subsection{$U = \infty$}
Remember that $U$ is the energy of the Coloumb interaction from double occupancy of the impurities defined in \eqref{eq:hf}.
\begin{equation}
	\Ha = E_0\sum_\sigma F_\sigma^\dagger F_\sigma + \sum_{k,\sigma}\varepsilon_k c_{k\sigma}^\dagger c_{k\sigma} + V\sum_{k,\sigma}\left(F_\sigma^\dagger c_{k\sigma} + c_{k\sigma}^\dagger F_\sigma\right)
\end{equation}
Our constraint reads
\begin{equation}
\sum_m F_m^\dagger F_m \le 1,
\end{equation}
i.e. we have \underline{no} double occupancy. As we did for the Hubbard model at $U = \infty$, wee introduce $b$-bosons.
\begin{align*}
	F_m^\dagger &= f_m^\dagger b \\
	F_m &= f_mb^\dagger\\
	\sum_m &f_m^\dagger f_m + b^\dagger b = 1
\end{align*}
$F_m, F_m^\dagger$ are Hubbard operators, and does not satisfy simple commutation relations. When this restriction is satisfied, we have
\begin{equation}
	\Ha = E_0\sum_m f_m^\dagger f_m + \sum_{k,\sigma}\varepsilon_k c_{k\sigma}^\dagger c_{k\sigma} + V\sum_{k,\sigma}\left(f_\sigma^\dagger bc_{k\sigma} + c_{k\sigma}^\dagger b^\dagger f_\sigma\right)
\end{equation}
with the restriction 
\begin{equation}
	\sum_m f_m^\dagger f_m + b^\dagger b = 1 \equiv Q.
\end{equation}
As we did for  $U=\infty$ Hubbard:
\begin{align}
	\Z &= \int\mathcal{D}c^\dagger\mathcal{D}c\mathcal{D}f^\dagger\mathcal{D}f\mathcal{D}b^\dagger\mathcal{D}b\,\e^{\Sa}\delta_{Q,1} \\
	\begin{split}
	\Sa &= -\sum_m\int_0^\beta \dd{\tau} f_m^\dagger\left(\partial_\tau + E_0\right)f_m - \sum_{k,\sigma}\int_0^\beta \dd{\tau} c_{k\sigma}\left(\partial_\tau + \varepsilon_k\right) c_{k\sigma}) \\
	&\quad -\int_0^\beta \dd{\tau}b^\dagger\partial_\tau b - V\sum_{k, \sigma}\int_0^\beta \dd{\tau}\left(c_{k\sigma}^\dagger b^\dagger f_\sigma + f_\sigma^\dagger b c_{k\sigma}\right).
	\end{split}
\end{align}
Again, we use Abrikosov's trick, that for each value of $\tau$ use that
\begin{align}
	\delta_{Q,1} &= \int_{-\pi}^\pi \frac{\dd{\lambda}}{2\pi}\e^{-i\lambda(Q-1)} \\
	\Rightarrow \Z &= \int_{-\pi}^\pi \frac{\dd{\lambda}}{2\pi}\int\mathcal{D}c^\dagger\mathcal{D}c\mathcal{D}f^\dagger\mathcal{D}f\mathcal{D}b^\dagger\mathcal{D}b\,\e^{\tilde{\Sa}} \\
	\begin{split}
		\tilde{\Sa} &= -\sum_m\int_0^\beta \dd{\tau} f_m^\dagger\left(\partial_\tau + E_0 + i\lambda\right)f_m - \sum_{k,\sigma}\int_0^\beta \dd{\tau} c_{k\sigma}\left(\partial_\tau + \varepsilon_k\right) c_{k\sigma}) \\
		&\quad -\int_0^\beta \dd{\tau}b^\dagger\left(\partial_\tau + i\lambda\right) b - V\sum_{k, \sigma}\int_0^\beta \dd{\tau}\left(c_{k\sigma}^\dagger b^\dagger f_\sigma + f_\sigma^\dagger b c_{k\sigma}\right) + i\int_{0}^\beta\dd{\tau}\lambda  
	\end{split}
\end{align}
Again we introduce $\Gre = \partial_\tau + \varepsilon_k$, and make a shift of the $c$-fields:
\begin{align*}
	\sum_{k\sigma}&\left[c_{k\sigma}^\dagger \Gre^{-1}c_{k\sigma} + V\left(c_{k\sigma}^\dagger b^\dagger f_\sigma + f_\sigma^\dagger bc_{k\sigma}\right)\right]\\
	&=\sum_{k,\sigma}\underbrace{\left(c_{k\sigma}^\dagger + Vf_{\sigma}^\dagger b\Gre\right)}_{\tilde{c}^\dagger}\Gre^{-1}\left(c_{k\sigma} + V\Gre b^\dagger f_\sigma\right) \\
	&\quad - V^2\sum_\sigma f_\sigma^\dagger b\left(\sum_k\Gre\right)b^\dagger f_\sigma
\end{align*}
Now, do the functional integrals $\int\mathcal{D}\tilde{c}^\dagger\mathcal{D}\tilde{c}$ such that $\Z = \Z_0\cdot\tilde{\Z}$ with 
\begin{equation*}
\Z_0 = \e^{\Tr\ln\Gre^{-1}}
\end{equation*}
and
\begin{equation*}
	\tilde{\Z} = \int_{-\pi}^\pi \frac{\dd{\lambda}}{2\pi}\int\mathcal{D}f^\dagger\mathcal{D}f\mathcal{D}b^\dagger\mathcal{D}b\,\e^{\Sa_{\text{eff}}},
\end{equation*}
where 
\begin{align*}
\Sa_{\text{eff}} = \int_0^\beta\dd{\tau}[-b^\dagger\left(\partial_\tau + i\lambda\right)b &- \sum_m f_m^\dagger\left(\partial_\tau + E_0 + i\lambda\right)f_m\\
&+ \sum_m f_m^\dagger V^2 b\left(\sum_k\Gre\right)b^\dagger f_m \\
&+i\lambda]
\end{align*}
We can now do the $\int\mathcal{D}f^\dagger\mathcal{D}f$-integration:
\begin{equation}
	\tilde{\Z} = \int_{-\pi}^\pi\frac{\dd{\lambda}}{2\pi}\int\mathcal{D}b^\dagger\mathcal{D}b\,\e^{\tilde{\Sa}_{\text{eff}}[b^\dagger, b, \lambda]}.
\end{equation}
The theory is now bosonized, with
\begin{align}
\tilde{\Sa}_{\text{eff}}[b^\dagger, b, \lambda] &= -\int_0^\beta \dd{\tau}\left(b^\dagger\left(\partial_\tau + i\lambda\right)b + i\lambda\right) + \Tr\ln(\mathcal{G}_f^{-1}[b^\dagger, b, \lambda]) \\
\mathcal{G}_f^{-1} &= \partial_\tau + E_0 + i\lambda-V^2b^\dagger\left(\sum_k\frac{1}{\partial_\tau + \varepsilon_k}\right)b
\end{align}
Remembering the results \eqref{eq:fermi_propagator} for $U=0$, we see that $U=\infty$ has two effects:
\begin{enumerate}[i]
	\item Shift of $E_0$
	\item Renormalized hybridisation
\end{enumerate} 
Again, the resulting effective action is to complicated to be calculated exactly. Let us therefore introduce a saddle point approximation by
\begin{align*}
b(\tau)&= b\\
i\lambda &=\lambda.
\end{align*}

\begin{align}
	\tilde{\Sa}_{\text{eff}} &= -\beta\lambda(b^2-1) + \Tr\ln\left(\partial_\tau + E_0 + \lambda-V^2b^2\sum_k\Gre\right)\nonumber \\
	&=-\beta\lambda(b^2-1) + \sum_\sigma\sum_{\omega_n}\ln\left(-i\omega_n + \varepsilon_f + s_0^2\sum_k\frac{1}{i\omega_n-\varepsilon_k}\right)\nonumber \\
	&= -\beta\lambda(b^2-1) + 2\sum_{\omega_n}\ln\left(-\omega_n + \varepsilon_f -i\Delta\mathrm{sgn}(\omega_n)\right)\nonumber \\
	\label{eq:effective_action}
	&= -\beta\lambda(b^2-1) + 2\beta\int_{-D}^D \frac{\dd{\varepsilon}}{\pi}f(\varepsilon)\tan[-1](\frac{\Delta}{\varepsilon_f - \varepsilon}),
\end{align}
where we introduced $s_0 \equiv bV, \Delta \equiv \pi\rho_0s_0^2$ and followed the same derivation as \eqref{eq:action_derivation} with the appropriate changes.
If we compare \eqref{eq:effective_action} with the effective action from the $U = 0$ -case,
\begin{equation}
	\Sa_{\text{eff}, U=0}  = 2\beta\int_{-D}^D\frac{\dd{\varepsilon}}{\pi}f(\varepsilon)\tan[-1](\frac{\Delta_0}{E_0 - \varepsilon}),
\end{equation}
we have for $U=\infty$ a shift in the scattering resonance at $\varepsilon_f = E_0 + \lambda$. As we will now see, $\varepsilon_f$ is ``nailed'' to the Fermi-level, such that even if $E_0$ is far outside the conduction band, $\varepsilon_f$ is practically on the Fermi level. Thus, impurities always affect the physics at the Fermi level. This permanent nailing is the origin of the Kondo-effect and heavy-fermion behaviour. \textbf{This is thus a correlation effect.}